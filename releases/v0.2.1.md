# Release v0.2.1 - Detailed Sleep Sessions

**Release Date:** 2026-01-17

## ğŸ¯ What's New

### Detailed Sleep Sessions Tool

Added new `get_sleep_sessions` tool that provides granular sleep data with exact timestamps and multiple sleep periods per day.

## âœ¨ Features

### New Tool: `get_sleep_sessions`

Retrieves detailed sleep period data from the Oura API's `/v2/usercollection/sleep` endpoint, providing:

- **Exact Sleep Times**: Precise bedtime start/end timestamps (e.g., "21:30 â†’ 07:15")
- **Multiple Sleep Periods**: Detects and displays biphasic/polyphasic sleep patterns
- **Per-Period Breakdown**: Detailed sleep stage analysis for each sleep session
- **Nap Detection**: Includes all sleep periods, including short naps and couch sleep
- **Enhanced Metrics**: Sleep efficiency and latency per session

### Key Capabilities

1. **Multi-Period Sleep Detection**
   - Automatically groups and labels multiple sleep sessions per day
   - Clear visual separation between periods
   - Helpful for tracking biphasic sleep patterns or interrupted sleep

2. **Detailed Sleep Stage Analysis**
   - Deep sleep duration and percentage
   - REM sleep duration and percentage
   - Light sleep duration and percentage
   - Awake time tracking

3. **Timestamp Precision**
   - Exact bedtime start/end in local timezone
   - Human-readable time format (HH:MM)

## ğŸ“Š Example Output

```
ğŸ›ï¸ Detailed Sleep Sessions (Last 3 days)

ğŸ“… 2026-01-16

*2 sleep periods recorded (biphasic/polyphasic)*

### Period 1: 21:30 â†’ 23:15

**Total Sleep:** 1h 35m

- **Deep Sleep:** 25m (26.3%)
- **REM Sleep:** 30m (31.6%)
- **Light Sleep:** 35m (36.8%)
- **Awake Time:** 5m

**Efficiency:** 92%
**Sleep Latency:** 8m

### Period 2: 00:15 â†’ 07:30

**Total Sleep:** 6h 45m

- **Deep Sleep:** 95m (23.5%)
- **REM Sleep:** 125m (30.9%)
- **Light Sleep:** 175m (43.2%)
- **Awake Time:** 10m

**Efficiency:** 96%
**Sleep Latency:** 3m
```

## ğŸ”§ Usage

### Claude Desktop

Ask any of these questions:
- "Show me my sleep sessions for the last 3 days"
- "What were my exact sleep times last night?"
- "Get detailed sleep periods including naps"
- "Did I have multiple sleep periods last night?"

### API

```python
# Via MCP tool
{
  "tool": "get_sleep_sessions",
  "arguments": {
    "days": 3
  }
}
```

## ğŸ¯ Use Cases

### 1. Biphasic Sleep Tracking
Track intentional or unintentional multi-phase sleep patterns (e.g., nap + night sleep, segmented sleep)

### 2. Couch Sleep Detection
Identify when you fell asleep on the couch before moving to bed

### 3. Nap Analysis
Review short sleep periods during the day with full stage breakdown

### 4. Sleep Timing Analysis
Analyze exact bedtime patterns and their relationship to sleep quality

### 5. Sleep Interruption Tracking
Understand extended wake periods that split sleep into multiple sessions

## ğŸ› ï¸ Technical Details

### Implementation

- **API Endpoint**: `/v2/usercollection/sleep`
- **Data Processing**: Groups sessions by day, sorts chronologically
- **Timezone Handling**: Converts ISO 8601 timestamps to local time
- **Multi-Period Logic**: Automatically detects and labels multiple periods

### Files Modified

- `src/oura_mcp/core/server.py`:
  - Added `get_sleep_sessions` tool registration (line 290-303)
  - Added `_tool_get_sleep_sessions()` implementation (line 588-670)
  - Added tool call handler (line 349-352)

### API Client

The existing `OuraClient.get_sleep()` method was already implemented and now exposed via MCP tool.

## ğŸ“š Documentation Updates

- **README.md**: Added example queries for sleep sessions
- **PHASE2_QUICKSTART.md**: Added detailed sleep sessions tool documentation

## ğŸ”„ Upgrade Path

No breaking changes. Simply pull the latest code and restart the server:

```bash
cd /path/to/oura-mcp-server
git pull
docker-compose restart  # or restart your local server
```

## ğŸ› Bug Fixes

None - this is a pure feature addition.

## ğŸš€ What's Next

This release completes the sleep data access layer. Future releases may include:
- Heart rate variability sessions
- Workout session details
- Long-term sleep pattern analysis
- Automated sleep schedule recommendations

## ğŸ“ Notes

- Requires Oura Ring Gen 3 with active subscription
- Sleep sessions sync automatically from Oura app
- Multiple periods per day are common and normal (e.g., nap + night sleep)
- All timestamps are in your local timezone

## ğŸ™ Credits

Feature requested by users tracking biphasic sleep patterns and needing granular sleep timing data.

---

**Installation:** See [README.md](../README.md) for setup instructions

**Full Documentation:** See [PHASE2_QUICKSTART.md](../docs/PHASE2_QUICKSTART.md)

**Previous Release:** [v0.2.0](v0.2.0.md) - Intelligence Layer
